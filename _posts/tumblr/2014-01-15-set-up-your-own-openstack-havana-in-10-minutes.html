---
layout: post
title: Set up your own OpenStack Havana in 10 minutes
date: '2014-01-15T13:52:00+02:00'
tags:
- openstack
- opensource
- softlayer
tumblr_url: https://blog.mist.io/post/73402239574/set-up-your-own-openstack-havana-in-10-minutes
---
<p>Supporting <a href="http://www.openstack.org/">OpenStack </a>was a choice we made when <a href="https://mist.io/">Mist.io</a> was still a prototype. Back then, OpenStack was notoriously difficult to install. Fortunately things got better and better over time. Now it is much easier and streamlined.</p>
<p>The following is not meant to be production-grade. It is just a way to quickly set up Havana, the latest version of OpenStack, for testing purposes. The steps should be similar for any environment though. We will use <a href="http://devstack.org/">DevStack</a> to speed up and simplify our installation. DevStack is a shell script to easily build complete development environments. </p>
<p>After we&rsquo;re done, we’ll end up with a working Havana deployment, the latest version of Openstack. We will also illustrate how to configure the network and ip auto-assignment so that you can start rolling out VMs.</p>
<p>We chose to install it on a bare metal server from <a href="http://www.softlayer.com/">Softlayer</a> with the following specs:</p>
<ul><li>1 Processor: Intel Xeon-SandyBridge E5-2620-HexCore [2GHz] </li>
<li>16 GB Ram</li>
<li>Public ips in the form of 159.253.138.184/29. This way we ended up with a public ip and secondary public ips on the subnet</li>
<li>OS: Ubuntu 12.04-64 minimal install</li>
</ul><p>We decided to go with a bare metal server from Softlayer because we wanted to control the entire environment (CPU, I/O) and avoid noisy neighbors to further test OpenStack. The price/performance ratio is hard to beat so you get more out of your $$$. Softlayer is already integrated with Mist.io and we can provision servers really fast ;)</p>
<p><img alt="image" src="https://66.media.tumblr.com/14b9688eb78e376d35ca463334b88564/tumblr_inline_mze7idBUqw1rgqrs8.jpg"/></p>
<p>With our Softlayer server launched, we’ll use git to download DevStack and install OpenStack:</p>
<pre>sudo apt-get install git</pre>
<pre>git clone <a href="https://github.com/openstack-dev/devstack.git">https://github.com/openstack-dev/devstack.git</a></pre>
<pre>cp samples/localrc localrc</pre>
<p>In our machine we have two main interfaces:</p>
<ul><li>bond0 (internal network)</li>
<li>bond1 (public network)</li>
</ul><p>We&rsquo;ll edit localrc and config our network by adding the following:</p>
<pre>HOST_IP: our public ip<br/>FLAT_INTERFACE: The best way is to assign br100 interface to it<br/>FLOATING_RANGE: 159.253.138.184/29<br/>PUBLIC_INTERFACE=bond1 (this is the interface for our internal network used by OpenStack services to communicate with each other)</pre>
<p>And then finish the OpenStack installation.</p>
<pre>cd devstack; ./stack.sh</pre>
<p>Doing so, we end up with a working OpenStack environment, with floating ips and all, however we have to assign a floating ip manually to each newly created instance. In order to auto assign ips from the floating ips pool we have to configure a floating ip pool:</p>
<pre>sudo nova-manage floating create --pool pool_auto_assign --ip_range 159.253.138.184/29</pre>
<p>Set auto_assign_floating_ip = True in nova.conf file and restart nova-networking.</p>
<p>Finally, we modify the nova.conf file by adding:</p>
<pre>default_floating_pool = pool_auto_assign<br/>floating_range = 159.253.138.184/29<br/>auto_assign_floating_ip = True</pre>
<p>Restart nova-network and that&rsquo;s it!</p>
<p>We now have a working OpenStack Havana installation that auto-assigns IP addresses. To test everything works ok we&rsquo;ll spin up some VMs. OpenStack&rsquo;s dashboard Horizon is ok but we want to get these together with our machines on EC2 so let&rsquo;s do it from Mist.io. First we add our OpenStack backend.</p>
<p><img alt="image" src="https://66.media.tumblr.com/a8db9f99f3abc4834e234aa3b1193fc1/tumblr_inline_mz4usfYR0j1rgqrs8.png" width="250px"/></p>
<p>And we&rsquo;re ready to roll. We can now create, destroy, reboot and monitor our virtual machines running on our own OpenStack cloud through Mist.io.</p>
<p><img alt="image" src="https://66.media.tumblr.com/62a48073bc28446f0d9d37819079267e/tumblr_inline_mze7iw8gpc1rgqrs8.png"/></p>

<p><strong>Do you have machines across clouds and want to easily manage them? <a href="https://mist.io">Sign up for Mist.io and try it for free!</a></strong></p>
